module m_Calculate_mu_w
!
! Purpose:
! To calculate the mu and w values for the quadrature set
!
! Record of revisions:
! Date          Programmer      Description of change
! ==========    ==========      =====================
! 31/10/2024    Daniel Beer     Original code
!
implicit none

contains

    subroutine calculate_mu(mu)

        integer                   :: N_Angles
        real(kind=8), intent(out) :: mu(:)

        N_Angles = 2*size(mu)

          if (N_Angles == 2) then
            mu(1) = 0.5773502691896257_8
          else if (N_Angles == 4) then
            mu(1) = 0.3500212_8
            mu(2) = 0.8688903_8 
          else if (N_Angles == 6) then
            mu(1) = 0.2666355_8
            mu(2) = 0.6815076_8
            mu(3) = 0.9261808_8
          else if (N_Angles == 8) then
            mu(1) = 0.2182179_8
            mu(2) = 0.5773503_8
            mu(3) = 0.7867958_8
            mu(4) = 0.9511897_8
          else if (N_Angles == 12) then
            mu(1) = 0.1672126_8
            mu(2) = 0.4595476_8
            mu(3) = 0.6280191_8
            mu(4) = 0.7600210_8
            mu(5) = 0.8722706_8
            mu(6) = 0.9716377_8
          else if (N_Angles == 16) then
            mu(1) = 0.1389568_8
            mu(2) = 0.3922893_8
            mu(3) = 0.5370966_8
            mu(4) = 0.6504264_8
            mu(5) = 0.7467506_8
            mu(6) = 0.8319966_8
            mu(7) = 0.9092855_8
            mu(8) = 0.9805009_8
          else
            write(*,*) 'Error: Number of Angles not supported'
            stop
          end if

    end subroutine calculate_mu

    subroutine calculate_xsi(xsi)

      integer                   :: N_Angles
      real(kind=8), intent(out) :: xsi(:)

      N_Angles = size(xsi)

        if (N_Angles == 2) then
          xsi(1) = 0.5773502691896257_8
          xsi(2) = -0.5773502691896257_8
        else if (N_Angles == 4) then
          xsi(1) = 0.8688903_8
          xsi(2) = 0.3500212_8
          xsi(3) = -0.3500212_8
          xsi(4) = -0.8688903_8
        else if (N_Angles == 6) then
          xsi(1) = 0.9261808_8
          xsi(2) = 0.6815076_8
          xsi(3) = 0.2666355_8
          xsi(4) = -0.2666355_8
          xsi(5) = -0.6815076_8
          xsi(6) = -0.9261808_8
        else if (N_Angles == 8) then
          xsi(1) = 0.9511897_8
          xsi(2) = 0.7867958_8
          xsi(3) = 0.5773503_8
          xsi(4) = 0.2182179_8
          xsi(5) = -0.2182179_8
          xsi(6) = -0.5773503_8
          xsi(7) = -0.7867958_8
          xsi(8) = -0.9511897_8
        else if (N_Angles == 12) then
          xsi(1) = 0.9716377_8
          xsi(2) = 0.8722706_8
          xsi(3) = 0.7600210_8
          xsi(4) = 0.6280191_8
          xsi(5) = 0.4595476_8
          xsi(6) = 0.1672126_8
          xsi(7) = -0.1672126_8
          xsi(8) = -0.4595476_8
          xsi(9) = -0.6280191_8
          xsi(10) = -0.7600210_8
          xsi(11) = -0.8722706_8
          xsi(12) = -0.9716377_8
        else if (N_Angles == 16) then
          xsi(1) = 0.9805009_8
          xsi(2) = 0.9092855_8
          xsi(3) = 0.8319966_8
          xsi(4) = 0.7467506_8
          xsi(5) = 0.6504264_8
          xsi(6) = 0.5370966_8
          xsi(7) = 0.3922893_8
          xsi(8) = 0.1389568_8
          xsi(9) = -0.1389568_8
          xsi(10) = -0.3922893_8
          xsi(11) = -0.5370966_8
          xsi(12) = -0.6504264_8
          xsi(13) = -0.7467506_8
          xsi(14) = -0.8319966_8
          xsi(15) = -0.9092855_8
          xsi(16) = -0.9805009_8
        else
          write(*,*) 'Error: Number of Angles not supported'
          stop
        end if

        xsi = -xsi

    end subroutine calculate_xsi

    subroutine calculate_w(w)

        integer                   :: N_Angles
        real(kind=8), intent(out) :: w(:)

        N_Angles = NINT(SQRT(1.0 + 8*REAL(size(w))) - 1)

        if (N_Angles == 2) then
            w = 1.0_8
        else if (N_Angles == 4) then
            w = 0.3333333333_8
        else if (N_Angles == 6) then
            w(1) = 0.1761263_8
            w(2) = 0.1572071_8
            w(3) = 0.1761263_8
            w(4) = 0.1572071_8
            w(5) = 0.1572071_8
            w(6) = 0.1761263_8
        else if (N_Angles == 8) then
            w(1) = 0.1209877_8
            w(2) = 0.0907407_8
            w(3) = 0.0907407_8
            w(4) = 0.1209877_8
            w(5) = 0.0907407_8
            w(6) = 0.0925926_8
            w(7) = 0.0907407_8
            w(8) = 0.0907407_8
            w(9) = 0.0907407_8
            w(10) = 0.1209877_8
        else if (N_Angles == 12) then
            w(1) = 0.0707626_8
            w(2) = 0.0558811_8
            w(3) = 0.0373377_8
            w(4) = 0.0373377_8
            w(5) = 0.0558811_8
            w(6) = 0.0707626_8
            w(7) = 0.0558811_8
            w(8) = 0.0502819_8
            w(9) = 0.0258513_8
            w(10) = 0.0502819_8
            w(11) = 0.0558811_8
            w(12) = 0.0373377_8
            w(13) = 0.0258513_8
            w(14) = 0.0258513_8
            w(15) = 0.0373377_8
            w(16) = 0.0373377_8
            w(17) = 0.0502819_8
            w(18) = 0.0373377_8
            w(19) = 0.0558811_8
            w(20) = 0.0558811_8
            w(21) = 0.0707626_8
        else if (N_Angles == 16) then
            w(1) = 0.0489872_8
            w(2) = 0.0413296_8
            w(3) = 0.0212326_8
            w(4) = 0.0256207_8
            w(5) = 0.0256207_8
            w(6) = 0.0212326_8
            w(7) = 0.0413296_8
            w(8) = 0.0489872_8
            w(9) = 0.0413296_8
            w(10) = 0.0360486_8
            w(11) = 0.0144589_8
            w(12) = 0.0344958_8
            w(13) = 0.0144589_8
            w(14) = 0.0360486_8
            w(15) = 0.0413296_8
            w(16) = 0.0212326_8
            w(17) = 0.0144589_8
            w(18) = 0.0085179_8
            w(19) = 0.0085179_8
            w(20) = 0.0144589_8
            w(21) = 0.0212326_8
            w(22) = 0.0256207_8
            w(23) = 0.0344958_8
            w(24) = 0.0085179_8
            w(25) = 0.0344958_8
            w(26) = 0.0256207_8
            w(27) = 0.0256207_8
            w(28) = 0.0144589_8
            w(29) = 0.0144589_8
            w(30) = 0.0256207_8
            w(31) = 0.0212326_8
            w(32) = 0.0360486_8
            w(33) = 0.0212326_8
            w(34) = 0.0413296_8
            w(35) = 0.0413296_8
            w(36) = 0.0489872_8
          else
            write(*,*) 'Error: Number of angles not supported', N_Angles
            stop
        end if

    end subroutine calculate_w

    function Calculate_Y_l_m(mu, eta, xsi, l, m) result(Y_l_m)
        integer, intent(in)         :: l, m
        real(kind=8), intent(in)    :: mu, eta, xsi
        real(kind=8)                :: Y_l_m

        if (l == 0) then
          Y_l_m = 1.0_8
        else if (l == 1) then
          if (m == 0) then
            Y_l_m = mu
          else if (m == 1) then
            Y_l_m = eta
          else if (m == -1) then
            Y_l_m = xsi
          else
            write(*,*) 'Error: m value not supported'
            stop
          end if
        else if (l == 2) then
          if (m == 0) then
            Y_l_m = 0.5_8 * (3.0_8 * mu**2 - 1.0_8)
          else if (m == 1) then
            Y_l_m = 3.0_8 * mu * eta
          else if (m == 2) then
            Y_l_m = 3.0_8 * (eta**2 - xsi**2)
          else if (m == -1) then
            Y_l_m = 3.0_8 * mu * xsi
          else if (m == -2) then
            Y_l_m = 6.0_8 * xsi * eta
          else
            write(*,*) 'Error: m value not supported'
            stop
          end if
        else if (l == 3) then
          if (m == 0) then
            Y_l_m = 0.5_8 * (5.0_8 * mu**3 - 3.0_8 * mu)
          else if (m == 1) then
            Y_l_m = 1.5_8 * (5.0_8 * mu**2 - 1.0_8) * eta
          else if (m == 2) then
            Y_l_m = 15.0_8 * mu * (eta**2 - xsi**2)
          else if (m == 3) then
            Y_l_m = 15.0_8 * eta * (eta**2 - 3.0_8 * xsi**2)
          else if (m == -1) then
            Y_l_m = 1.5_8 * (5.0_8 * mu**2 - 1.0_8) * xsi
          else if (m == -2) then
            Y_l_m = 30.0_8 * mu * eta * xsi
          else if (m == -3) then
            Y_l_m = 15.0_8 * (3.0_8 * eta**2 - xsi**2) * xsi
          else
            write(*,*) 'Error: m value not supported'
            stop
          end if
        else
          write(*,*) 'Error: l value not supported'
          stop
        end if

        if (m == 0) then

          Y_l_m = SQRT(REAL(fact(l - ABS(m)),8)/REAL(fact(l + ABS(m)),8))*Y_l_m

        else

          Y_l_m = SQRT(2.0_8*REAL(fact(l - ABS(m)),8)/REAL(fact(l + ABS(m)),8))*Y_l_m

        end if

    end function Calculate_Y_l_m

    integer function fact(n)

        integer, intent(in) :: n
        integer :: i

        if (n < 0) error stop 'factorial is singular for negative integers'
        fact = 1.0
        do i = 2, n
            fact = fact * i
        end do

    end function fact

    subroutine calculate_mu_1D(mu)

      integer                   :: N_Angles
      real(kind=8), intent(out) :: mu(:)

      N_Angles = size(mu)

      if (N_Angles == 2) then
        mu(1) = 0.5773502691896257_8
        mu(2) = -0.5773502691896257_8  
      else if (N_Angles == 4) then
        mu(1) = 0.8611363115940526_8
        mu(2) = 0.3399810435848563_8
        mu(3) = -0.3399810435848563_8
        mu(4) = -0.8611363115940526_8
      else if (N_Angles == 6) then
        mu(1) = 0.932469514203152_8
        mu(2) = 0.6612093864662645_8
        mu(3) = 0.2386191860831969_8
        mu(4) = -0.2386191860831969_8
        mu(5) = -0.6612093864662645_8
        mu(6) = -0.932469514203152_8
      else if (N_Angles == 8) then
        mu(1) = 0.9602898564975363_8
        mu(2) = 0.7966664774136267_8
        mu(3) = 0.5255324099163290_8
        mu(4) = 0.1834346424956498_8
        mu(5) = -0.1834346424956498_8
        mu(6) = -0.5255324099163290_8
        mu(7) = -0.7966664774136267_8
        mu(8) = -0.9602898564975363_8
      else if (N_Angles == 12) then
        mu(1) = 0.981560634246719_8
        mu(2) = 0.9041172563704747_8
        mu(3) = 0.7699026741943047_8
        mu(4) = 0.5873179542866174_8
        mu(5) = 0.3678314989981802_8
        mu(6) = 0.1252334085114689_8
        mu(7) = -0.1252334085114689_8
        mu(8) = -0.3678314989981802_8
        mu(9) = -0.5873179542866174_8
        mu(10) = -0.7699026741943047_8
        mu(11) = -0.9041172563704747_8
        mu(12) = -0.981560634246719_8
      else if (N_Angles == 16) then
        mu(1) = 0.9894009349916499_8
        mu(2) = 0.9445750230732326_8
        mu(3) = 0.8656312023878318_8
        mu(4) = 0.7554044083550030_8
        mu(5) = 0.6178762444026438_8
        mu(6) = 0.4580167776572274_8
        mu(7) = 0.2816035507792589_8
        mu(8) = 0.0950125098376374_8
        mu(9) = -0.0950125098376374_8
        mu(10) = -0.2816035507792589_8
        mu(11) = -0.4580167776572274_8
        mu(12) = -0.6178762444026438_8
        mu(13) = -0.7554044083550030_8
        mu(14) = -0.8656312023878318_8
        mu(15) = -0.9445750230732326_8
        mu(16) = -0.9894009349916499_8
      else if (N_Angles == 36) then
        mu(1) = 0.9978304624840858_8
        mu(2) = 0.9885864789022122_8
        mu(3) = 0.9720276910496980_8
        mu(4) = 0.9482729843995076_8
        mu(5) = 0.9174977745156591_8
        mu(6) = 0.8799298008903972_8
        mu(7) = 0.8358471669924753_8
        mu(8) = 0.7855762301322066_8
        mu(9) = 0.7294891715935565_8
        mu(10) = 0.6680012365855210_8
        mu(11) = 0.6015676581359806_8
        mu(12) = 0.5306802859262452_8
        mu(13) = 0.4558639444334203_8
        mu(14) = 0.3776725471196892_8
        mu(15) = 0.2966849953440283_8
        mu(16) = 0.2135008923168656_8
        mu(17) = 0.1287361038093848_8
        mu(18) = 0.0430181984737086_8
        mu(19) = -0.0430181984737086_8
        mu(20) = -0.1287361038093848_8
        mu(21) = -0.2135008923168656_8
        mu(22) = -0.2966849953440283_8
        mu(23) = -0.3776725471196892_8
        mu(24) = -0.4558639444334203_8
        mu(25) = -0.5306802859262452_8
        mu(26) = -0.6015676581359806_8
        mu(27) = -0.6680012365855210_8
        mu(28) = -0.7294891715935565_8
        mu(29) = -0.7855762301322066_8
        mu(30) = -0.8358471669924753_8
        mu(31) = -0.8799298008903972_8
        mu(32) = -0.9174977745156591_8
        mu(33) = -0.9482729843995076_8
        mu(34) = -0.9720276910496980_8
        mu(35) = -0.9885864789022122_8
        mu(36) = -0.9978304624840858_8
      else if (N_Angles == 64) then
        mu(1) = 0.9993050417357722_8
        mu(2) = 0.9963401167719553_8
        mu(3) = 0.9910133714767443_8
        mu(4) = 0.9833362538846256_8
        mu(5) = 0.9733268277899109_8
        mu(6) = 0.9610087996520538_8
        mu(7) = 0.9464113748584028_8
        mu(8) = 0.9295691721319396_8
        mu(9) = 0.9105221370785028_8
        mu(10) = 0.8893154459951141_8
        mu(11) = 0.8659993981540928_8
        mu(12) = 0.8406292962525803_8
        mu(13) = 0.8132653151227975_8
        mu(14) = 0.7839723589433414_8
        mu(15) = 0.7528199072605319_8
        mu(16) = 0.7198818501716108_8
        mu(17) = 0.6852363130542333_8
        mu(18) = 0.6489654712546573_8
        mu(19) = 0.6111553551723933_8
        mu(20) = 0.5718956462026340_8
        mu(21) = 0.5312794640198945_8
        mu(22) = 0.4894031457070529_8
        mu(23) = 0.4463660172534641_8
        mu(24) = 0.4022701579639916_8
        mu(25) = 0.3572201583376681_8
        mu(26) = 0.3113228719902109_8
        mu(27) = 0.2646871622087674_8
        mu(28) = 0.2174236437400071_8
        mu(29) = 0.1696444204239928_8
        mu(30) = 0.1214628192961206_8
        mu(31) = 0.0729931217877990_8
        mu(32) = 0.0243502926634244_8
        mu(33) = -0.0243502926634244_8
        mu(34) = -0.0729931217877990_8
        mu(35) = -0.1214628192961206_8
        mu(36) = -0.1696444204239928_8
        mu(37) = -0.2174236437400071_8
        mu(38) = -0.2646871622087674_8
        mu(39) = -0.3113228719902109_8
        mu(40) = -0.3572201583376681_8
        mu(41) = -0.4022701579639916_8
        mu(42) = -0.4463660172534641_8
        mu(43) = -0.4894031457070529_8
        mu(44) = -0.5312794640198945_8
        mu(45) = -0.5718956462026340_8
        mu(46) = -0.6111553551723933_8
        mu(47) = -0.6489654712546573_8
        mu(48) = -0.6852363130542333_8
        mu(49) = -0.7198818501716108_8
        mu(50) = -0.7528199072605319_8
        mu(51) = -0.7839723589433414_8
        mu(52) = -0.8132653151227975_8
        mu(53) = -0.8406292962525803_8
        mu(54) = -0.8659993981540928_8
        mu(55) = -0.8893154459951141_8
        mu(56) = -0.9105221370785028_8
        mu(57) = -0.9295691721319396_8
        mu(58) = -0.9464113748584028_8
        mu(59) = -0.9610087996520538_8
        mu(60) = -0.9733268277899109_8
        mu(61) = -0.9833362538846256_8
        mu(62) = -0.9910133714767443_8
        mu(63) = -0.9963401167719553_8
        mu(64) = -0.9993050417357722_8
      else
        write(*,*) 'Error: Number of Angles not supported'
        stop
      end if

    end subroutine calculate_mu_1D

    subroutine calculate_w_1D(w)

      integer                   :: N_Angles
      real(kind=8), intent(out) :: w(:)

      N_Angles = size(w)

      if (N_Angles == 2) then
          w(1) = 1.0_8
          w(2) = 1.0_8
      else if (N_Angles == 4) then
          w(1) = 0.3478548451_8
          w(2) = 0.6521451549_8
          w(3) = 0.6521451549_8
          w(4) = 0.3478548451_8
      else if (N_Angles == 6) then
          w(1) = 0.1713244924_8
          w(2) = 0.3607615730_8
          w(3) = 0.4679139346_8
          w(4) = 0.4679139346_8
          w(5) = 0.3607615730_8
          w(6) = 0.1713244924_8
      else if (N_Angles == 8) then
          w(1) = 0.1012285363_8
          w(2) = 0.2223810345_8
          w(3) = 0.3137066459_8
          w(4) = 0.3626837834_8
          w(5) = 0.3626837834_8
          w(6) = 0.3137066459_8
          w(7) = 0.2223810345_8
          w(8) = 0.1012285363_8
      else if (N_Angles == 12) then
          w(1) = 0.0471753364_8
          w(2) = 0.1069393259_8
          w(3) = 0.1600783285_8
          w(4) = 0.2031674267_8
          w(5) = 0.2334925365_8
          w(6) = 0.2491470458_8
          w(7) = 0.2491470458_8
          w(8) = 0.2334925365_8
          w(9) = 0.2031674267_8
          w(10) = 0.1600783285_8
          w(11) = 0.1069393259_8
          w(12) = 0.0471753364_8
      else if (N_Angles == 16) then
          w(1) = 0.0271524594_8
          w(2) = 0.0622535239_8
          w(3) = 0.0951585116_8
          w(4) = 0.1246289712_8
          w(5) = 0.1495959888_8
          w(6) = 0.1691565193_8
          w(7) = 0.1826034150_8
          w(8) = 0.1894506104_8
          w(9) = 0.1894506104_8
          w(10) = 0.1826034150_8
          w(11) = 0.1691565193_8
          w(12) = 0.1495959888_8
          w(13) = 0.1246289712_8
          w(14) = 0.0951585116_8
          w(15) = 0.0622535239_8
          w(16) = 0.0271524594_8
      else if (N_Angles == 36) then
          w(1) = 0.0055657197_8
          w(2) = 0.0129159473_8
          w(3) = 0.0201815153_8
          w(4) = 0.0272986215_8
          w(5) = 0.0342138107_8
          w(6) = 0.0408757509_8
          w(7) = 0.0472350835_8
          w(8) = 0.0532447139_8
          w(9) = 0.0588601442_8
          w(10) = 0.0640397975_8
          w(11) = 0.0687453238_8
          w(12) = 0.0729418850_8
          w(13) = 0.0765984106_8
          w(14) = 0.0796878289_8
          w(15) = 0.0821872667_8
          w(16) = 0.0840782189_8
          w(17) = 0.0853466857_8
          w(18) = 0.0859832757_8
          w(19) = 0.0859832757_8
          w(20) = 0.0853466857_8
          w(21) = 0.0840782189_8
          w(22) = 0.0821872667_8
          w(23) = 0.0796878289_8
          w(24) = 0.0765984106_8
          w(25) = 0.0729418850_8
          w(26) = 0.0687453238_8
          w(27) = 0.0640397975_8
          w(28) = 0.0588601442_8
          w(29) = 0.0532447139_8
          w(30) = 0.0472350835_8
          w(31) = 0.0408757509_8
          w(32) = 0.0342138107_8
          w(33) = 0.0272986215_8
          w(34) = 0.0201815153_8
          w(35) = 0.0129159473_8
          w(36) = 0.0055657197_8
        else if (N_Angles == 64) then
          w(1) = 0.0017832807_8
          w(2) = 0.0041470333_8
          w(3) = 0.0065044579_8
          w(4) = 0.0088467598_8
          w(5) = 0.0111681395_8
          w(6) = 0.0134630479_8
          w(7) = 0.0157260304_8
          w(8) = 0.0179517158_8
          w(9) = 0.0201348231_8
          w(10) = 0.0222701738_8
          w(11) = 0.0243527026_8
          w(12) = 0.0263774697_8
          w(13) = 0.0283396726_8
          w(14) = 0.0302346571_8
          w(15) = 0.0320579284_8
          w(16) = 0.0338051618_8
          w(17) = 0.0354722132_8
          w(18) = 0.0370551285_8
          w(19) = 0.0385501532_8
          w(20) = 0.0399537411_8
          w(21) = 0.0412625632_8
          w(22) = 0.0424735151_8
          w(23) = 0.0435837245_8
          w(24) = 0.0445905582_8
          w(25) = 0.0454916279_8
          w(26) = 0.0462847966_8
          w(27) = 0.0469681828_8
          w(28) = 0.0475401657_8
          w(29) = 0.0479993886_8
          w(30) = 0.0483447622_8
          w(31) = 0.0485754674_8
          w(32) = 0.0486903154_8
          w(33) = 0.0486898923_8
          w(34) = 0.0485748294_8
          w(35) = 0.0483457951_8
          w(36) = 0.0479993886_8
          w(37) = 0.0475401657_8
          w(38) = 0.0469681828_8
          w(39) = 0.0462847966_8
          w(40) = 0.0454916279_8
          w(41) = 0.0445905582_8
          w(42) = 0.0435837245_8
          w(43) = 0.0424735151_8
          w(44) = 0.0412625632_8
          w(45) = 0.0399537411_8
          w(46) = 0.0385501532_8
          w(47) = 0.0370551285_8
          w(48) = 0.0354722132_8
          w(49) = 0.0338051618_8
          w(50) = 0.0320579284_8
          w(51) = 0.0302346571_8
          w(52) = 0.0283396726_8
          w(53) = 0.0263774697_8
          w(54) = 0.0243527026_8
          w(55) = 0.0222701738_8
          w(56) = 0.0201348231_8
          w(57) = 0.0179517158_8
          w(58) = 0.0157260304_8
          w(59) = 0.0134630479_8
          w(60) = 0.0111681395_8
          w(61) = 0.0088467598_8
          w(62) = 0.0065044579_8
          w(63) = 0.0041470333_8
          w(64) = 0.0017832807_8
        else
          write(*,*) 'Error: Number of angles not supported'
          stop
      end if

    end subroutine calculate_w_1D

    subroutine calculate_P_l(mu, l, P_l)
      integer                     :: l
      real(kind=8), intent(in)    :: mu
      real(kind=8), intent(inout) :: P_l

      if (l == 0) then
        P_l = 1.0_8
      else if (l == 1) then
        P_l = mu
      else if (l == 2) then
        P_l = 0.5_8 * (3.0_8 * mu**2 - 1.0_8)
      else if (l == 3) then
        P_l = 0.5_8 * (5.0_8 * mu**3 - 3.0_8 * mu)
      else if (l == 4) then
        P_l = 0.125_8 * (35.0_8 * mu**4 - 30.0_8 * mu**2 + 3.0_8)
      else if (l == 5) then
        P_l = 0.125_8 * (63.0_8 * mu**5 - 70.0_8 * mu**3 + 15.0_8 * mu)
      else if (l == 6) then
        P_l = 0.0625_8 * (231.0_8 * mu**6 - 315.0_8 * mu**4 + 105.0_8 * mu**2 - 5.0_8)
      else if (l == 7) then
        P_l = 0.0625_8 * (429.0_8 * mu**7 - 693.0_8 * mu**5 + 315.0_8 * mu**3 - 35.0_8 * mu)
      else if (l == 8) then
        P_l = 0.0078125_8 * (6435.0_8 * mu**8 - 12012.0_8 * mu**6 + 6930.0_8 * mu**4 - 1260.0_8 * mu**2 + 35.0_8)
      else if (l == 9) then
        P_l = 0.0078125_8 * (12155.0_8 * mu**9 - 25740.0_8 * mu**7 + 18018.0_8 * mu**5 - 4620.0_8 * mu**3 + 315.0_8 * mu)
      else if (l == 10) then
        P_l = 0.00390625_8 * (46189.0_8 * mu**10 - 109395.0_8 * mu**8 + 90090.0_8 * mu**6 - 30030.0_8 * mu**4 + 3465.0_8 * mu**2 - 63.0_8)
      else
        write(*,*) 'Error: l value not supported'
        stop
      end if

    end subroutine calculate_P_l

end module m_Calculate_mu_w